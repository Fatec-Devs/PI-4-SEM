// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model grupo {
  id_grupo Int @id @default(autoincrement())
  nome     String

  times            time[]
  funcionario_grupos funcionario_grupo[]

  @@map("grupo")
}

model funcionario {
  matricula String @id
  nome      String
  username  String @unique
  senha     String
  email     String?

  funcionario_grupos funcionario_grupo[]
  user_apps           user_app[]

  @@map("funcionario")
}

model time {
  id_time Int @id @default(autoincrement())
  nome    String
  id_grupo Int?
  pdl     String?

  grupo      grupo? @relation(fields: [id_grupo], references: [id_grupo])
  aplicacoes aplicacao[]

  @@map("time")
}

model funcionario_grupo {
  matricula_funcionario String
  id_grupo Int

  funcionario funcionario @relation(fields: [matricula_funcionario], references: [matricula])
  grupo      grupo       @relation(fields: [id_grupo], references: [id_grupo])

  @@id([matricula_funcionario, id_grupo])
  @@map("funcionario_grupo")
}

model user_app {
  id_user_app Int @id @default(autoincrement())
  username    String
  senha       String
  matricula_funcionario String?

  funcionario funcionario? @relation(fields: [matricula_funcionario], references: [matricula])
  aplicacao_user_app aplicacao_user_app[]

  @@map("user_app")
}

model aplicacao {
  id_app Int @id @default(autoincrement())
  component_tag String @unique
  nome String
  id_time Int?

  time time? @relation(fields: [id_time], references: [id_time])
  aplicacao_user_app aplicacao_user_app[]

  @@map("aplicacao")
}

model aplicacao_user_app {
  id_app Int
  id_user_app Int

  aplicacao aplicacao @relation(fields: [id_app], references: [id_app], onDelete: Cascade)
  user_app  user_app  @relation(fields: [id_user_app], references: [id_user_app], onDelete: Cascade)

  @@id([id_app, id_user_app])
  @@map("aplicacao_user_app")
}

